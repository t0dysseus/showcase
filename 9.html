<!DOCTYPE html>
<html lang="de">
<head>
    <style>
        :root { --tp-red: #ff2a2a; }
        body { background: #000; color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; font-family: monospace; }
        
        #visualizer {
            width: 150px; height: 150px;
            border: 3px solid var(--tp-red);
            box-shadow: 0 0 20px var(--tp-red);
            transition: transform 0.05s ease-out;
            display: flex; justify-content: center; align-items: center;
            font-weight: bold; text-align: center; padding: 10px;
        }

        button {
            margin-top: 50px; padding: 15px 30px; 
            background: none; border: 2px solid var(--tp-red); 
            color: var(--tp-red); cursor: pointer; font-family: monospace;
            font-weight: bold; letter-spacing: 2px;
        }
        button:hover { background: var(--tp-red); color: black; }
    </style>
</head>
<body>

    <div id="visualizer">TAGESPOST_CORE_REACTIVE</div>
    <button onclick="playStarWars()">INITIALIZE_MELODY</button>

    <script>
        function playStarWars() {
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const visualizer = document.getElementById('visualizer');

            // Frequenzen für die Noten (in Hz)
            const notes = {
                'G3': 196.00, 'C4': 261.63, 'G4': 392.00, 
                'F4': 349.23, 'E4': 329.63, 'D4': 293.66, 'C5': 523.25
            };

            // Melodie-Abfolge: [Note, Dauer in Sekunden]
            const melody = [
                ['G3', 0.5], ['G3', 0.5], ['G3', 0.5],
                ['C4', 1.5], ['G4', 1.5],
                ['F4', 0.25], ['E4', 0.25], ['D4', 0.25], ['C5', 1.5], ['G4', 1.0],
                ['F4', 0.25], ['E4', 0.25], ['D4', 0.25], ['C5', 1.5], ['G4', 1.0],
                ['F4', 0.25], ['E4', 0.25], ['F4', 0.25], ['D4', 1.5]
            ];

            let time = audioCtx.currentTime;

            melody.forEach(([note, duration]) => {
                playNote(notes[note], time, duration);
                // Visueller Effekt synchron zur Note planen
                setTimeout(() => {
                    visualizer.style.transform = "scale(1.5)";
                    visualizer.style.borderColor = "#fff";
                    setTimeout(() => {
                        visualizer.style.transform = "scale(1.0)";
                        visualizer.style.borderColor = "var(--tp-red)";
                    }, duration * 800);
                }, (time - audioCtx.currentTime) * 1000);

                time += duration;
            });

            function playNote(freq, startTime, duration) {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();

                osc.type = 'square'; // 'square' klingt nach altem Arcade/Technik-Sound
                osc.frequency.setValueAtTime(freq, startTime);

                // Lautstärke-Hüllkurve (verhindert Knacken)
                gain.gain.setValueAtTime(0, startTime);
                gain.gain.linearRampToValueAtTime(0.2, startTime + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);

                osc.connect(gain);
                gain.connect(audioCtx.destination);

                osc.start(startTime);
                osc.stop(startTime + duration);
            }
        }
    </script>
</body>
</html>